@page "/register"
@using System.ComponentModel.DataAnnotations
@inject NavigationManager Nav
@inject IAuthService AuthService

<div class="login-wrapper">
    <div class="login-container">
        <div class="login-header">
            <div class="gibz-logo-text">GIBZ</div>
            <h1>Erstellen Sie Ihr Konto</h1>
            <p>Registrieren Sie sich für das Zeugnis-Notenanpassung System</p>
        </div>

        <div class="login-card">
            <EditForm Model="@registerDto" OnValidSubmit="RegisterUser">
                <DataAnnotationsValidator />

                <div class="form-group mb-3">
                    <label class="form-label">Vollständiger Name</label>
                    <div class="input-group">
                        <span class="input-group-text"><i class="bi bi-person"></i></span>
                        <InputText @bind-Value="registerDto.FullName" class="form-control" placeholder="Vor- und Nachname" />
                    </div>
                    <ValidationMessage For="@(() => registerDto.FullName)" class="text-danger small" />
                </div>

                <div class="form-group mb-3">
                    <label class="form-label">E-Mail-Adresse</label>
                    <div class="input-group">
                        <span class="input-group-text"><i class="bi bi-envelope"></i></span>
                        <InputText @bind-Value="registerDto.Email" class="form-control" placeholder="beispiel.beispiel@gibz.ch" />
                    </div>
                    <ValidationMessage For="@(() => registerDto.Email)" class="text-danger small" />
                </div>

                <div class="form-group mb-3">
                    <label class="form-label">Passwort</label>
                    <div class="input-group">
                        <span class="input-group-text"><i class="bi bi-lock"></i></span>
                        <InputText @bind-Value="registerDto.Password" type="password" class="form-control" placeholder="Mindestens 6 Zeichen" />
                    </div>
                    <ValidationMessage For="@(() => registerDto.Password)" class="text-danger small" />
                </div>

                <div class="form-group mb-4">
                    <label class="form-label">Passwort bestätigen</label>
                    <div class="input-group">
                        <span class="input-group-text"><i class="bi bi-shield-check"></i></span>
                        <InputText @bind-Value="registerDto.ConfirmPassword" type="password" class="form-control" placeholder="Passwort wiederholen" />
                    </div>
                    <ValidationMessage For="@(() => registerDto.ConfirmPassword)" class="text-danger small" />
                </div>

                <button type="submit" class="btn btn-gibz w-100 mb-3">
                    Registrieren
                </button>

                <div class="text-center">
                    <a href="/" class="register-link">Bereits registriert? Jetzt anmelden</a>
                </div>
            </EditForm>
        </div>

        <footer class="login-footer">
            © 2025 GIBZ – Gewerblich-Industrielle Berufsschule Zug
        </footer>
    </div>
</div>

@code {
    private RegisterUserDTO registerDto = new();

    private async Task RegisterUser()
    {
        var success = await AuthService.RegisterAsync(registerDto);
        if (success)
        {
            Nav.NavigateTo("/requests");
        }
    }
}